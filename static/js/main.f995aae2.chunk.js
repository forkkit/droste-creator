(this["webpackJsonpdroste-creator"]=this["webpackJsonpdroste-creator"]||[]).push([[0],{32:function(e,t,n){},33:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n(1),r=n(7),c=n.n(r),s=n(3),i=n(5),l=n.n(i);function d(e){return[e[4]*e[8]-e[5]*e[7],e[2]*e[7]-e[1]*e[8],e[1]*e[5]-e[2]*e[4],e[5]*e[6]-e[3]*e[8],e[0]*e[8]-e[2]*e[6],e[2]*e[3]-e[0]*e[5],e[3]*e[7]-e[4]*e[6],e[1]*e[6]-e[0]*e[7],e[0]*e[4]-e[1]*e[3]]}function j(e,t){for(var n=Array(9),a=0;3!=a;++a)for(var o=0;3!=o;++o){for(var r=0,c=0;3!=c;++c)r+=e[3*a+c]*t[3*c+o];n[3*a+o]=r}return n}function x(e,t){return[e[0]*t[0]+e[1]*t[1]+e[2]*t[2],e[3]*t[0]+e[4]*t[1]+e[5]*t[2],e[6]*t[0]+e[7]*t[1]+e[8]*t[2]]}function h(e,t,n,a,o,r,c,s){var i=[e,n,o,t,a,r,1,1,1],l=x(d(i),[c,s,1]);return j(i,[l[0],0,0,0,l[1],0,0,0,l[2]])}function f(e,t,n,a,o,r,c,s,i,l){var x=function(e,t,n,a,o,r,c,s,i,l,x,f,p,m,u,b){var g=h(e,t,o,r,i,l,p,m);return j(h(n,a,c,s,x,f,u,b),d(g))}(0,0,n,a,e,0,o,r,0,t,c,s,e,t,i,l);for(let d=0;9!=d;++d)x[d]=x[d]/x[8];return[x[0],x[3],0,x[6],x[1],x[4],0,x[7],0,0,1,0,x[2],x[5],0,x[8]]}function p(e){const[t,n,a,o,r,c,s,i,l,d,j,x,h,f,p,m]=e,u=[[t,n,a,o],[r,c,s,i],[l,d,j,x],[h,f,p,m]];for(var b,g=u.length,O=[],y=0;y<g;y++)O[y]=[];for(y=0;y<g;y++)for(var v=0;v<g;v++)O[y][v]=0,y==v&&(O[y][v]=1);for(var w=0;w<g;w++){b=u[w][w];for(v=0;v<g;v++)u[w][v]/=b,O[w][v]/=b;for(y=w+1;y<g;y++){b=u[y][w];for(v=0;v<g;v++)u[y][v]-=u[w][v]*b,O[y][v]-=O[w][v]*b}}for(w=g-1;w>0;w--)for(y=w-1;y>=0;y--){b=u[y][w];for(v=0;v<g;v++)u[y][v]-=u[w][v]*b,O[y][v]-=O[w][v]*b}for(y=0;y<g;y++)for(v=0;v<g;v++)u[y][v]=O[y][v];return u}n(32);function m({distance:e,angle:t}){return{x:e*Math.cos(t),y:e*Math.sin(t)}}function u({x:e,y:t}){return{distance:Math.sqrt(Math.pow(e,2)+Math.pow(t,2)),angle:Math.atan2(t,e)}}const b="matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)",g=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],O={Off:"Off (Edit)",In:"In",Out:"Out"},y={Slow:"3s",Default:"1.2s",Fast:"0.7s",Faster:"0.2s"};function v({label:e,value:t,options:n,onChange:r,disabled:c=!1}){const[i,l]=Object(o.useState)(!1),d=Object(o.useRef)();return((e,t)=>{const n=n=>{e.current&&!e.current.contains(n.target)&&t()};Object(o.useEffect)((()=>(document.addEventListener("click",n),()=>{document.removeEventListener("click",n)})))})(d,(()=>{l(!1)})),Object(a.jsxs)("div",{className:"dropdown ".concat(i?"":"-hide"," ").concat(c?"-disabled":""),ref:d,onClick:()=>{l(!c&&!i)},children:[Object(a.jsxs)(s.d,{className:"dropdown-header",children:[e," ",Object(a.jsx)("strong",{children:n[t]})]}),Object(a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:Object(a.jsx)("polyline",{points:"6 9 12 15 18 9"})}),Object(a.jsx)("div",{className:"dropdown-options",children:Object.keys(n).map((e=>Object(a.jsx)("div",{className:"dropdown-option",onClick:()=>{r(e),l(!1)},children:Object(a.jsx)(s.d,{children:n[e]})},e)))})]})}const w={Flor:{src:"flor.jpg",ratio:1,example:[.852,.001,1.1312,.6366,-.073,.28,.148,.999],deep:32},"Chichen Itza":{src:"chichenitza.svg",ratio:1,example:[.12,.05,.88,.05,.1,27/32,.9,27/32],deep:8},"Tokyo 1":{src:"tokyo1.jpg",ratio:3/4,example:[.15,.2,.85,.2,.15,.9,.85,.9],deep:32},"Tokyo 2":{src:"tokyo2.jpg",ratio:3/4,example:[.15,.2,.85,.2,.15,.9,.85,.9],deep:32},"Tokyo 3":{src:"tokyo3.jpg",ratio:3/4,example:[.15,.2,.85,.2,.15,.9,.85,.9],deep:32}};var k=function(){const[e,t]=Object(o.useState)(w[Object.keys(w)[Math.floor(Math.random()*Object.keys(w).length)]]),n=Math.min(window.innerHeight-64,window.innerWidth/e.ratio),r=n*e.ratio,c=n,[i,d]=Object(o.useState)(!1),[j,x]=Object(o.useState)("handleDrag"),[h,k]=Object(o.useState)(e.deep||32),N=window.innerWidth-r>300,M=!!N||i,[D,C]=Object(o.useState)("Off"),[L,A]=Object(o.useState)("Default"),[S,E]=Object(o.useState)([{x:r*e.example[0],y:c*e.example[1]},{x:r*e.example[2],y:c*e.example[3]},{x:r*e.example[4],y:c*e.example[5]},{x:r*e.example[6],y:c*e.example[7]}]);Object(o.useEffect)((()=>{const n=Math.min(window.innerHeight-64,window.innerWidth/e.ratio),a=n*e.ratio,o=n;t(e),k(e.deep||32),E([{x:a*e.example[0],y:o*e.example[1]},{x:a*e.example[2],y:o*e.example[3]},{x:a*e.example[4],y:o*e.example[5]},{x:a*e.example[6],y:o*e.example[7]}])}),[e]);const P={handleDrag:function({x:e,y:t},n){E((a=>{const o=[...a];return o[n]={x:e,y:t},o}))},handleDragMirror:function({x:e,y:t},n){E((a=>{const o=[...a];return o[n]={x:e,y:t},o[function(e){return 0===e?3:1===e?2:2===e?1:3===e?0:void 0}(n)]={x:r-e,y:c-t},o}))},handleDragLockAspect:function({x:e,y:t},n){E((a=>{const o=[...a];o[n]={x:e,y:t};const s=o[0],i=u({x:o[3].x-s.x,y:o[3].y-s.y}),l=u({x:r,y:0}),d=u({x:0,y:c}),j=u({x:r,y:c}),x=Math.sqrt(r*r+c*c),h=Math.sqrt(Math.pow(o[3].x-s.x,2)+Math.pow(o[3].y-s.y,2)),f={distance:h/x*r,angle:i.angle+l.angle-j.angle};o[1]={x:s.x+m(f).x,y:s.y+m(f).y};const p={distance:h/x*c,angle:i.angle+d.angle-j.angle};return o[2]={x:s.x+m(p).x,y:s.y+m(p).y},o}))}},W=f(r,c,S[0].x-0*r,S[0].y-0*c,S[1].x-0*r,S[1].y-0*c,S[2].x-0*r,S[2].y-0*c,S[3].x-0*r,S[3].y-0*c),H="matrix3d(".concat(p(W).join(","),")"),I=p(W).flat().map(((e,t)=>.25*e+.75*g[t])),F="matrix3d(".concat(I.join(","),")"),q=p(W).flat().map(((e,t)=>.5*e+.5*g[t])),R="matrix3d(".concat(q.join(","),")"),T=p(W).flat().map(((e,t)=>.75*e+.25*g[t])),z="matrix3d(".concat(T.join(","),")");function B(e){const[t,n,a,o,r,c,s,i,l,d,j,x,h,f,p,m]=e;return[t,r,h,n,c,f,o,i,m]}function V(e,t){const n=B(e),a=B(t);return[(o=function(e,t){for(var n=Array(9),a=0;3!=a;++a)for(var o=0;3!=o;++o){for(var r=0,c=0;3!=c;++c)r+=e[3*a+c]*t[3*c+o];n[3*a+o]=r}return n}(n,a))[0],o[3],0,o[6],o[1],o[4],0,o[7],0,0,1,0,o[2],o[5],0,o[8]];var o}const J=[g];for(let a=1;a<h;a++)J.push(V(J[a-1],W.flat()));return Object(a.jsxs)(o.Fragment,{children:[Object(a.jsxs)("div",{className:"main",onClick:()=>{d(!1)},children:[Object(a.jsx)(s.b,{accent:"#e74c3c"}),Object(a.jsx)("div",{className:"img image-container-cut",style:{height:c,width:r,overflow:"hidden"},children:Object(a.jsx)("div",{className:"image-container -transformable",style:{animation:"loop".concat(D," ").concat(y[L]," linear infinite")},children:J.map(((t,n)=>Object(a.jsx)("img",{alt:"",className:"img -transformed -transformable",style:{width:r,height:c,transform:"matrix3d(".concat(t.join(","),")")},src:e.src},n+e.src)))})}),Object(a.jsx)(l.a,{defaultPosition:S[0],position:S[0],onDrag:(e,t)=>P[j](t,0),children:Object(a.jsx)("button",{style:{display:"Off"===D?"block":"none"},className:"point",children:"0"})}),"handleDragLockAspect"!==j&&Object(a.jsx)(l.a,{defaultPosition:S[1],position:S[1],onDrag:(e,t)=>P[j](t,1),children:Object(a.jsx)("button",{style:{display:"Off"===D?"block":"none"},className:"point",children:"1"})}),"handleDragLockAspect"!==j&&Object(a.jsx)(l.a,{defaultPosition:S[2],position:S[2],onDrag:(e,t)=>P[j](t,2),children:Object(a.jsx)("button",{style:{display:"Off"===D?"block":"none"},className:"point",children:"2"})}),Object(a.jsx)(l.a,{defaultPosition:S[3],position:S[3],onDrag:(e,t)=>P[j](t,3),children:Object(a.jsx)("button",{style:{display:"Off"===D?"block":"none"},className:"point",children:"3"})})]}),Object(a.jsxs)("div",{className:"sidebar ".concat(M?"":"-hide"),children:[Object(a.jsx)("div",{className:"sidebar-element",children:Object(a.jsx)(v,{label:"Controls",value:j,options:{handleDrag:"Free",handleDragMirror:"Mirror",handleDragLockAspect:"Aspect Lock"},onChange:x})}),Object(a.jsx)("div",{className:"sidebar-element",children:Object(a.jsx)(v,{label:"Depth",value:h,options:{8:8,16:16,32:32,72:72,128:128,256:"256 \u26a0\ufe0f"},onChange:e=>k(Number(e))})}),Object(a.jsx)("div",{className:"sidebar-element",children:Object(a.jsx)(v,{label:"Animation",value:D,options:O,onChange:C})}),Object(a.jsx)("div",{className:"sidebar-element",children:Object(a.jsx)(v,{disabled:"Off"==D,label:"Animation Speed",value:L,options:y,onChange:A})}),!1,Object(a.jsx)("hr",{}),Object(a.jsx)("div",{className:"sidebar-element",children:Object(a.jsx)(v,{label:"Load Example",value:null,options:Object.keys(w),onChange:e=>{const n=w[Object.keys(w)[e]];t(n)}})}),!1,!1]}),Object(a.jsxs)("div",{className:"topnav",children:[Object(a.jsxs)(s.d,{style:{flex:1,display:"flex",flexWrap:"wrap"},children:[Object(a.jsx)("div",{children:"Droste"}),Object(a.jsx)("strong",{children:"Creator"})]}),Object(a.jsx)("div",{style:{flex:1}}),Object(a.jsxs)("div",{className:"jb-file-uploader-container",children:[Object(a.jsx)(s.a,{onClick:()=>{alert("PRANK")},children:"New Picture"}),Object(a.jsx)("input",{className:"jb-file-uploader",type:"file",onChange:function(e){e.stopPropagation(),e.preventDefault();const n=e.dataTransfer,a=(n?n.files:e.target.files)[0],o=new window.FileReader;o.onload=async e=>{const n=e.currentTarget.result,[a,o]=await async function(e,t=529984){return new Promise((n=>{let a=new Image;a.src=e,a.onload=()=>{let e=document.createElement("canvas");const o=a.width,r=a.height;let c=a.width,s=a.height;for(;c*s>t;)c/=Math.sqrt(2,2),s/=Math.sqrt(2,2);c=Math.round(c),s=Math.round(s),e.width=c,e.height=s,e.getContext("2d").drawImage(a,0,0,c,s),n([e.toDataURL(),{originalWidth:o,originalHeight:r}])}}))}(n);t({src:a,ratio:o.originalWidth/o.originalHeight,example:[.2,.2,.8,.2,.2,.8,.8,.8],deep:20})},o.readAsDataURL(a)},multiple:!0,accept:"image/*","aria-label":"Drop an image here, or click to select"})]}),Object(a.jsx)(s.c,{w:1}),!N&&Object(a.jsx)(s.a,{onClick:()=>{d(!i)},children:Object(a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[Object(a.jsx)("circle",{cx:"12",cy:"12",r:"3"}),Object(a.jsx)("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})]})})]}),Object(a.jsx)("style",{children:"\n        @keyframes loopIn {\n          0% {\n            transform: ".concat(H,";\n          }\n          25% {\n            transform: ").concat(z,";\n          }\n          50% {\n            transform: ").concat(R,";\n          }\n          75% {\n            transform: ").concat(F,";\n          }\n          100% {\n            transform: ").concat(b,";\n          }\n        }\n\n        @keyframes loopOut {\n          0% {\n            transform: ").concat(b,";\n          }\n          100% {\n            transform: ").concat(H,";\n          }\n        }\n      ")})]},e.src)};c.a.render(Object(a.jsx)(k,{}),document.getElementById("root"))}},[[33,1,2]]]);
//# sourceMappingURL=main.f995aae2.chunk.js.map