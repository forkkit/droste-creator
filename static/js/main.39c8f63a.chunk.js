(this["webpackJsonpdroste-creator"]=this["webpackJsonpdroste-creator"]||[]).push([[0],{32:function(e,t,n){},33:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n(1),o=n(7),c=n.n(o),s=n(3),i=n(5),l=n.n(i);function d(e){return[e[4]*e[8]-e[5]*e[7],e[2]*e[7]-e[1]*e[8],e[1]*e[5]-e[2]*e[4],e[5]*e[6]-e[3]*e[8],e[0]*e[8]-e[2]*e[6],e[2]*e[3]-e[0]*e[5],e[3]*e[7]-e[4]*e[6],e[1]*e[6]-e[0]*e[7],e[0]*e[4]-e[1]*e[3]]}function j(e,t){for(var n=Array(9),a=0;3!=a;++a)for(var r=0;3!=r;++r){for(var o=0,c=0;3!=c;++c)o+=e[3*a+c]*t[3*c+r];n[3*a+r]=o}return n}function h(e,t){return[e[0]*t[0]+e[1]*t[1]+e[2]*t[2],e[3]*t[0]+e[4]*t[1]+e[5]*t[2],e[6]*t[0]+e[7]*t[1]+e[8]*t[2]]}function x(e,t,n,a,r,o,c,s){var i=[e,n,r,t,a,o,1,1,1],l=h(d(i),[c,s,1]);return j(i,[l[0],0,0,0,l[1],0,0,0,l[2]])}function b(e,t,n,a,r,o,c,s,i,l){var h=function(e,t,n,a,r,o,c,s,i,l,h,b,p,f,m,u){var O=x(e,t,r,o,i,l,p,f);return j(x(n,a,c,s,h,b,m,u),d(O))}(0,0,n,a,e,0,r,o,0,t,c,s,e,t,i,l);for(let d=0;9!=d;++d)h[d]=h[d]/h[8];return[h[0],h[3],0,h[6],h[1],h[4],0,h[7],0,0,1,0,h[2],h[5],0,h[8]]}function p(e){const[t,n,a,r,o,c,s,i,l,d,j,h,x,b,p,f]=e,m=[[t,n,a,r],[o,c,s,i],[l,d,j,h],[x,b,p,f]];for(var u,O=m.length,g=[],y=0;y<O;y++)g[y]=[];for(y=0;y<O;y++)for(var v=0;v<O;v++)g[y][v]=0,y==v&&(g[y][v]=1);for(var w=0;w<O;w++){u=m[w][w];for(v=0;v<O;v++)m[w][v]/=u,g[w][v]/=u;for(y=w+1;y<O;y++){u=m[y][w];for(v=0;v<O;v++)m[y][v]-=m[w][v]*u,g[y][v]-=g[w][v]*u}}for(w=O-1;w>0;w--)for(y=w-1;y>=0;y--){u=m[y][w];for(v=0;v<O;v++)m[y][v]-=m[w][v]*u,g[y][v]-=g[w][v]*u}for(y=0;y<O;y++)for(v=0;v<O;v++)m[y][v]=g[y][v];return m}n(32);function f({distance:e,angle:t}){return{x:e*Math.cos(t),y:e*Math.sin(t)}}function m({x:e,y:t}){return{distance:Math.sqrt(Math.pow(e,2)+Math.pow(t,2)),angle:Math.atan2(t,e)}}const u="matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)",O=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],g={Off:"Off (Edit)",In:"In",Out:"Out"},y={Slow:"3s",Default:"1.2s",Fast:"0.7s",Faster:"0.2s"};function v({label:e,value:t,options:n,onChange:o,disabled:c=!1}){const[i,l]=Object(r.useState)(!1),d=Object(r.useRef)();return((e,t)=>{const n=n=>{e.current&&!e.current.contains(n.target)&&t()};Object(r.useEffect)((()=>(document.addEventListener("click",n),()=>{document.removeEventListener("click",n)})))})(d,(()=>{l(!1)})),Object(a.jsxs)("div",{className:"dropdown ".concat(i?"":"-hide"," ").concat(c?"-disabled":""),ref:d,onClick:()=>{l(!c&&!i)},children:[Object(a.jsxs)(s.e,{className:"dropdown-header",children:[e," ",Object(a.jsx)("strong",{children:n[t]})]}),Object(a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:Object(a.jsx)("polyline",{points:"6 9 12 15 18 9"})}),Object(a.jsx)("div",{className:"dropdown-options",children:Object.keys(n).map((e=>Object(a.jsx)("div",{className:"dropdown-option",onClick:()=>{o(e),l(!1)},children:Object(a.jsx)(s.e,{children:n[e]})},e)))})]})}const w={Flor:{src:"flor.jpg",ratio:1,example:[.852,.001,1.1312,.6366,-.073,.28,.148,.999],deep:32},"Chichen Itza":{src:"chichenitza.svg",ratio:1,example:[.12,.05,.88,.05,.1,27/32,.9,27/32],deep:8},"Tokyo 1":{src:"tokyo1.jpg",ratio:3/4,example:[.15,.2,.85,.2,.15,.9,.85,.9],deep:32},"Tokyo 2":{src:"tokyo2.jpg",ratio:3/4,example:[.15,.2,.85,.2,.15,.9,.85,.9],deep:32},"Tokyo 3":{src:"tokyo3.jpg",ratio:3/4,example:[.15,.2,.85,.2,.15,.9,.85,.9],deep:32}};var k=function(){const[e,t]=Object(r.useState)(w[Object.keys(w)[Math.floor(Math.random()*Object.keys(w).length)]]),n=Math.min(window.innerHeight-64,window.innerWidth/e.ratio),o=n*e.ratio,c=n,[i,d]=Object(r.useState)(!1),[j,h]=Object(r.useState)("handleDrag"),[x,k]=Object(r.useState)(e.deep||32),N=window.innerWidth-o>300,D=!!N||i,[M,C]=Object(r.useState)("Off"),[L,A]=Object(r.useState)("Default"),[S,E]=Object(r.useState)([{x:o*e.example[0],y:c*e.example[1]},{x:o*e.example[2],y:c*e.example[3]},{x:o*e.example[4],y:c*e.example[5]},{x:o*e.example[6],y:c*e.example[7]}]);Object(r.useEffect)((()=>{const n=Math.min(window.innerHeight-64,window.innerWidth/e.ratio),a=n*e.ratio,r=n;t(e),k(e.deep||32),E([{x:a*e.example[0],y:r*e.example[1]},{x:a*e.example[2],y:r*e.example[3]},{x:a*e.example[4],y:r*e.example[5]},{x:a*e.example[6],y:r*e.example[7]}])}),[e]);const W={handleDrag:function({x:e,y:t},n){E((a=>{const r=[...a];return r[n]={x:e,y:t},r}))},handleDragMirror:function({x:e,y:t},n){E((a=>{const r=[...a];return r[n]={x:e,y:t},r[function(e){return 0===e?3:1===e?2:2===e?1:3===e?0:void 0}(n)]={x:o-e,y:c-t},r}))},handleDragLockAspect:function({x:e,y:t},n){E((a=>{const r=[...a];r[n]={x:e,y:t};const s=r[0],i=m({x:r[3].x-s.x,y:r[3].y-s.y}),l=m({x:o,y:0}),d=m({x:0,y:c}),j=m({x:o,y:c}),h=Math.sqrt(o*o+c*c),x=Math.sqrt(Math.pow(r[3].x-s.x,2)+Math.pow(r[3].y-s.y,2)),b={distance:x/h*o,angle:i.angle+l.angle-j.angle};r[1]={x:s.x+f(b).x,y:s.y+f(b).y};const p={distance:x/h*c,angle:i.angle+d.angle-j.angle};return r[2]={x:s.x+f(p).x,y:s.y+f(p).y},r}))}},H=b(o,c,S[0].x-0*o,S[0].y-0*c,S[1].x-0*o,S[1].y-0*c,S[2].x-0*o,S[2].y-0*c,S[3].x-0*o,S[3].y-0*c),I="matrix3d(".concat(p(H).join(","),")"),P=p(H).flat().map(((e,t)=>.25*e+.75*O[t])),F="matrix3d(".concat(P.join(","),")"),q=p(H).flat().map(((e,t)=>.5*e+.5*O[t])),T="matrix3d(".concat(q.join(","),")"),z=p(H).flat().map(((e,t)=>.75*e+.25*O[t])),R="matrix3d(".concat(z.join(","),")");function B(e){const[t,n,a,r,o,c,s,i,l,d,j,h,x,b,p,f]=e;return[t,o,x,n,c,b,r,i,f]}function V(e,t){const n=B(e),a=B(t);return[(r=function(e,t){for(var n=Array(9),a=0;3!=a;++a)for(var r=0;3!=r;++r){for(var o=0,c=0;3!=c;++c)o+=e[3*a+c]*t[3*c+r];n[3*a+r]=o}return n}(n,a))[0],r[3],0,r[6],r[1],r[4],0,r[7],0,0,1,0,r[2],r[5],0,r[8]];var r}const J=[O];for(let a=1;a<x;a++)J.push(V(J[a-1],H.flat()));return Object(a.jsxs)(r.Fragment,{children:[Object(a.jsxs)("div",{className:"main",onClick:()=>{d(!1)},children:[Object(a.jsx)(s.c,{accent:"#e74c3c"}),Object(a.jsx)("div",{className:"img image-container-cut",style:{height:c,width:o,overflow:"hidden"},children:Object(a.jsx)("div",{className:"image-container -transformable",style:{animation:"loop".concat(M," ").concat(y[L]," linear infinite")},children:J.map(((t,n)=>Object(a.jsx)("img",{alt:"",className:"img -transformed -transformable",style:{width:o,height:c,transform:"matrix3d(".concat(t.join(","),")")},src:e.src},n+e.src)))})}),Object(a.jsx)(l.a,{defaultPosition:S[0],position:S[0],onDrag:(e,t)=>W[j](t,0),children:Object(a.jsx)("button",{style:{display:"Off"===M?"block":"none"},className:"point",children:"0"})}),"handleDragLockAspect"!==j&&Object(a.jsx)(l.a,{defaultPosition:S[1],position:S[1],onDrag:(e,t)=>W[j](t,1),children:Object(a.jsx)("button",{style:{display:"Off"===M?"block":"none"},className:"point",children:"1"})}),"handleDragLockAspect"!==j&&Object(a.jsx)(l.a,{defaultPosition:S[2],position:S[2],onDrag:(e,t)=>W[j](t,2),children:Object(a.jsx)("button",{style:{display:"Off"===M?"block":"none"},className:"point",children:"2"})}),Object(a.jsx)(l.a,{defaultPosition:S[3],position:S[3],onDrag:(e,t)=>W[j](t,3),children:Object(a.jsx)("button",{style:{display:"Off"===M?"block":"none"},className:"point",children:"3"})})]}),Object(a.jsxs)("div",{className:"sidebar ".concat(D?"":"-hide"),children:[Object(a.jsx)("div",{className:"sidebar-element",children:Object(a.jsx)(v,{label:"Controls",value:j,options:{handleDrag:"Free",handleDragMirror:"Mirror",handleDragLockAspect:"Aspect Lock"},onChange:h})}),Object(a.jsx)("div",{className:"sidebar-element",children:Object(a.jsx)(v,{label:"Depth",value:x,options:{8:8,16:16,32:32,72:72,128:128,256:"256 \u26a0\ufe0f"},onChange:e=>k(Number(e))})}),Object(a.jsx)("div",{className:"sidebar-element",children:Object(a.jsx)(v,{label:"Animation",value:M,options:g,onChange:C})}),Object(a.jsx)("div",{className:"sidebar-element",children:Object(a.jsx)(v,{disabled:"Off"==M,label:"Animation Speed",value:L,options:y,onChange:A})}),Object(a.jsx)("hr",{}),Object(a.jsx)("div",{className:"sidebar-element",children:Object(a.jsx)(v,{label:"Load Example",value:null,options:Object.keys(w),onChange:e=>{const n=w[Object.keys(w)[e]];t(n)}})}),Object(a.jsx)("div",{className:"sidebar-element",children:Object(a.jsxs)(s.e,{children:["Droste Creator is a tool to create recursive images. Source"," ",Object(a.jsx)(s.a,{href:"https://github.com/javierbyte/droste-creator",children:"Github"}),". Code and pictures by ",Object(a.jsx)(s.a,{href:"https://javier.xyz",children:"javierbyte"}),"."]})}),!1]}),Object(a.jsxs)("div",{className:"topnav",children:[Object(a.jsxs)(s.e,{style:{flex:1,display:"flex",flexWrap:"wrap"},children:[Object(a.jsx)("div",{children:"Droste"}),Object(a.jsx)("strong",{children:"Creator"})]}),Object(a.jsx)("div",{style:{flex:1}}),Object(a.jsxs)("div",{className:"jb-file-uploader-container",children:[Object(a.jsx)(s.b,{children:"New Picture"}),Object(a.jsx)("input",{className:"jb-file-uploader",type:"file",onChange:function(e){e.stopPropagation(),e.preventDefault();const n=e.dataTransfer,a=(n?n.files:e.target.files)[0],r=new window.FileReader;r.onload=async e=>{const n=e.currentTarget.result,[a,r]=await async function(e,t=529984){return new Promise((n=>{let a=new Image;a.src=e,a.onload=()=>{let e=document.createElement("canvas");const r=a.width,o=a.height;let c=a.width,s=a.height;for(;c*s>t;)c/=Math.sqrt(2,2),s/=Math.sqrt(2,2);c=Math.round(c),s=Math.round(s),e.width=c,e.height=s,e.getContext("2d").drawImage(a,0,0,c,s),n([e.toDataURL(),{originalWidth:r,originalHeight:o}])}}))}(n);t({src:a,ratio:r.originalWidth/r.originalHeight,example:[.2,.2,.8,.2,.2,.8,.8,.8],deep:20})},r.readAsDataURL(a)},multiple:!0,accept:"image/*","aria-label":"Drop an image here, or click to select"})]}),Object(a.jsx)(s.d,{w:1}),!N&&Object(a.jsx)(s.b,{onClick:()=>{d(!i)},children:Object(a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[Object(a.jsx)("circle",{cx:"12",cy:"12",r:"3"}),Object(a.jsx)("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})]})})]}),Object(a.jsx)("style",{children:"\n        @keyframes loopIn {\n          0% {\n            transform: ".concat(I,";\n          }\n          25% {\n            transform: ").concat(R,";\n          }\n          50% {\n            transform: ").concat(T,";\n          }\n          75% {\n            transform: ").concat(F,";\n          }\n          100% {\n            transform: ").concat(u,";\n          }\n        }\n\n        @keyframes loopOut {\n          0% {\n            transform: ").concat(u,";\n          }\n          100% {\n            transform: ").concat(I,";\n          }\n        }\n      ")})]},e.src)};c.a.render(Object(a.jsx)(k,{}),document.getElementById("root"))}},[[33,1,2]]]);
//# sourceMappingURL=main.39c8f63a.chunk.js.map